\documentclass[a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[left=1.25 in, right=1.25 in, top=1.25 in, bottom=1.25 in]{geometry}
\usepackage{hyperref}
\usepackage{gensymb}
\usepackage{bbold}
\usepackage{rotating}


% Bibliography
\usepackage[numbers, compress]{natbib} % Bibliography - APA
\bibpunct{(}{)}{;}{a}{}{,}
\usepackage{lineno} % Line numbers
\def\linenumberfont{\normalfont\footnotesize\ttfamily}
\setlength\linenumbersep{0.2 in}

\usepackage{setspace}

\newcommand{\ignore}[1]{}

\begin{document}

% \noindent
% \textbf{Title}: 

% \bigskip

% \noindent
% \textbf{Running title}: Interaction of resources: 

% \bigskip

% \noindent
% \textbf{Authors}: Mark Q. Wilber$^1$, Sarah Chinn, 

% \bigskip

% \noindent
% \textbf{Author affiliations}: \\

% \bigskip

% \noindent
% \textbf{Corresponding author}:

% \bigskip

% \noindent
% \textbf{Word count}:

% \bigskip

% \noindent
% \textbf{Keywords}:

% \newpage

\doublespacing
\linenumbers

\section*{Abstract}

\section*{Introduction}

Pigs eat everything. But they eat some things more than others. And when those ``some things'' are agricultural crops, it can result in extensive economic damage. [estimate].  However, crops are one of many forage resources competing for a feral swine's attention on a landscape.  As extreme generalists, feral swine consume anything from sapling trees, fungus, and masting seeds to small invertebrates and livestock. The availability of these different forage resources varies in both space and time, such that pigs will switch their foraging behavior  availability of these various potential resources  

% F-it, let's make this pig specific. 

% Management message: When are pigs using crops and how does this relate to the other resources that are available to them on a landscape? 

% Question 1: How does the availability of forage resource affect pig movement?
% Question 2: How does the selection for forage vary seasonally?
%		- Do we see seasonal shifts in forage forage resources?
% Question 3: Can changes in the use of forage resources across populations be described by temperature and precipitation?



% Outline

% SEE Choquenot 1996 Wildlife Research for a good citation for this approach

% Goal: Understand how crop availability affects pig movement over space and time and how natural food resources affect pigs selection of crops.  

% Paragraph 1: 
% 	- Could start out pig specific.  The problems pigs cause etc.
% 	- Could start more general regarding how individual-movement is diverse, but being able to elucidate general patterns across scales can help understand resource use and aid management (sorry Hugh! I will think about how).
% 	- Why do we care about movement? The first step to understanding population dynamics.  If we can get a good sense of movement dynamics we can explore disease transmission, reproduction, damage, etc. Individual-level movement is a means to an end. 

% Paragraph 2:
% 	- What do we know about pig movement (Harltey et al., Kay et al. 2017, Garza, Snow, Lewis, McClure).
% 	- With the exception of Hartley and Kay, these studies focused on movement at the large scale pig movement and and did not explicitly account for the dynamic pig movement\?
% 	- The disadvantage of these approaches is that they don't provide much to build upon.  In contrast, a dynamic model of pig movement and resource use will be applicable for population-level inferences. 
% 	-  Most movement studies have been focused on home-range size and factors than affect home range (Garza, and others).  While home range captures a fundamental aspect of feral swine biology, it misses critical patterns of movement \emph{within} a home range, which can have important implications for contact, reproduction, and resource use. 

\section*{Methods}

\subsection*{Data}

To analyze how forage availability affected pig movement patterns, we used GPS collar data collected on 500 pigs in the United States of America and Canada (Fig. 1).  Of the X pigs, X were male and Y were female. These data are from X different studies and were collected from May, 2004 to November, 2017.  The median collaring time per pig across all studies was X (95\% quantiles) (see supplementary material for additional details). The average time between GPS fixes varied by study, with the median fix time being X across all Y studies [95\% CI]. 

For each pig used in the study, we cleaned the movement trajectory using the following criteria. First, we excluded all 2D GPS fixes from the analysis \citep{Bjorneraas2010}.  Second, we eliminated the first and last 25 fixes for each pig to account for capture effects [citation]. Third, we eliminated all pig movements in which pigs moved faster than 50 km per hour over any distance or moved greater than 15 km per hour over a distance of 8 km or more. These movements are unlikely given previously observed patterns of feral swine movement \citep{Mayer2009}. Finally, we also removed large temporal gaps between fix times as these can lead to a large amount of uncertainty regarding a pig's location in between two temporally distant fixes. To do this, we split a single pig movement trajectory into multiple sequences when the time between two adjacent fixes was greater than \emph{c.} 130 minutes. We then discarded all sequences that had less than 150 fixes at least 130 minutes apart. The remaining sequences were considered independent ``runs'' for a given pig. We chose to only include sequences of 150 fixes as shorter runs would not always span the length of a day, precluding analysis of diel movement patterns, and longer runs excluded too many of the pigs from the analysis. After this cleaning, our analysis contained X pigs and a total of X fix times (Fig. 1).

\subsection*{Covariates}

The goal of our analysis was to understand how the availability of anthropogenic and natural forage on a landscape affected the movement and resource selection of feral swine. To address these goals, we identified covariates related to natural forage and anthropogenic forage resources that were comparable across the different studies used in this analysis.  For the availability of natural forage resources, we considered two proxies: plant productivity as measured by Normalized Difference Vegetation Index (NDVI) and density of masting trees (Table 1). We included masting tree density as masting events are an important component of pig diets and can have significant implications on population-level pig growth rates \citep[e.g.][]{Bieber2005}.  NDVI is a general correlate of plant productivity in an area \citep{Pettorelli2005} and, given that pigs are extreme generalists and plant material often makes up a large percentage of their diet \citep{Mayer2009}, we use NDVI to reflect the availability of herbaceous forage.  

% Moreover, we consider NDVI as time-varying covariate on the monthly scale, to account for the fact that pigs often shift their foraging activity to match available resources \citep{Mayer2009}.

For anthropogenic forage resources, we used agricultural data available from the National Agricultural Statistics Service (NASS). These data are obtained yearly at a 30m by 30m scale across the contiguous US. Each pixel specifies the dominant type of crop grown in that pixel.  While the NASS data enumerates 105 types of crop, we chose not to distinguish between crop types in our initial analyses. Instead, we used a generic grouping of ``crop'' vs. ``no-crop'', which allowed us to more easily explore how the effect of agricultural forage on pig movement varied across space and time [though maybe specific croptypes would be better].  We did consider specific crop types in our post-hoc analyses, in which we grouped the 105 crop types into 11 groups: cereals, oilseed, tobacco, beverage and spice, leguminous, grasses, sugar, root and tuber, fruit and nuts, vegetables and melons, and other crops [according the criteria outlined in...]. WHAT ABOUT CANADA?]

While our primary goal of this analysis was to understand the effect of forage availability on pig movement, pig movement and home range size is also driven by a number of other variables, including cover, water availability, temperature, pressure, human development, mammal diversity, sex, and age \citep{McClure2015,Garza2017,Kay2017} [MORE].  Of these additional predictors of pig movement, cover and water are critically important as both are necessary for pigs to thermoregulate \citep{Choquenot1996a} and cover, in particular, is necessary for protection from predators [citation] (citations in Mayer2009). We used tree canopy density data [check wording] from the National Landcover Database (NLCD) as a covariate for cover (Table 1). These data are available at a 30m by 30m scale for the contiguous United States. For a water, we used the National Wetland Inventory (NWI) Database which identifies X types of water bodies larger than X m2 in the continguous United States. For this study, we only considered the water sources that were permanent or semi-permanent as defined by the NWI and computed the distance to the nearest water source at a 30m by 30m resolution (see Table 1 and Sup Mat). 

We also included mean monthly temperature, total monthly precipitation, and distance to developed land/roads as additional covariates (Table 1). Note that while the inclusion of these covariates is import for capturing pig movement, our questions were focused the foraging resources, such that we considered non-foraging covariates "blocking" covariates and did not exhaustively explore their potential relationships and interactions beyond what had already been shown in the literature.  

Finally, we also considered a number of study-level variables to allow us to explore how and why the effect of natural forage resources and anthropogenic forage resources varied across different studies. To this end, we explored study-level covariates such as drought severity, ecoregion, local pig density, and MORE (see Table 1). 

\subsection*{Continuous-time, discrete-space movement model}

To understand role of forage resources on pig movement, we used the modeling framework of \cite{Hanks2015} and \cite{Wilson2018}.  Generally, this framework leverages auto-correlated animal movement data and gridded raster covariates to make inference about the resource utilization of an animal \citep{Hanks2015,Buderman2018,Wilson2018}.  

Specifically, this approach can be broken into two distinct steps. Given a trajectory of GPS fixes (not necessarily with equal fix times), the first step of this approach estimates animal movement as a function of continuous time at some particular temporal grain (e.g. 15 minutes).  To do this, we used a phenomenological functional movement model (FMM) \citep{Buderman2016,Hooten2017a}, which is a non-mechanistic, continuous-time movement model that can capture an animal's movement patterns at some desired-level of detail \citep{Buderman2016}.  The phenomenological FMM can be represented as a series of basis functions, which allow for large flexibility in animal movement patterns.
In particular, we used a B-spline basis expansion to model the longitude and latitude of an animal as a function of time (see Supplementary Material for additional detail).

In the second step of the analysis requires translating our continuous movement model into discrete, rasterized space.  To do this we used our fitted FMM to predict a pig's location at 15 minute intervals. We chose 15 minutes as this provided a reasonable trade-off between computational time and computing the exact amount of time spent in each cell, which is equivalent to letting the time between fixes go to zero [NOTE: Would this be hard to do? Double Check interpretation of 15 minute intervals...]. We then converted this predicted pig path into discrete 30m by 30m grid cells such that we were left with a continuous time movement path in discrete space (Fig. X). [We chose 30m by 30m ]
To account for the uncertainty in our movement model, we generated 20 continuous-time discrete space movement paths and performed all of the analyses described below on each of the movement paths \citep{Hanks2015,Buderman2018}.

Given these continuous-time, discrete-space trajectories, we then explored how agricultural and natural forage resources on a landscape affected pig movement using a continuous-time Markov Chain (CTMC) approach \cite{Hanks2015}. The CTMC approach considers continuous-time animal movement (i.e. the FMM model described above) through a discrete landscape. From this point-of-view, animal movement can be considered as a series of rates of moving from cell $i$ to an adjacent cell $j$, $\lambda_{ij}$.  As for any continuous-time Markov Chain, the process can be decomposed into the waiting time before a state change occurs (i.e. the time an animal spends in a cell) and the new state once a change occurs (i.e. the new cell to which the animal has moved) \citep{Allen2003a}.  With this interpretation, one can then model the rate of moving between cell $i$ and $j$ $\lambda_{ij}$ as a function of the environmental covariates in cell $i$ and $j$.  \cite{Hanks2015} showed this inference can be re-expressed as a latent-variable, Poisson Generalized Linear Model, where the response variable for adjacent cell $j$ is one if a pig moved to that cell from cell $i$, and 0 otherwise. Specifically, let $z_{ij}$ be the zero/one latent variable, then

\begin{align}
  z_{ij} &\sim \text{Poisson}(\lambda_{ij}) \\
  \log \lambda_{ij} &= \log{\tau_{ij}} + \beta \mathbf{X}
\end{align}
where $\tau_{ij}$ is the waiting time before moving from cell $i$ to cell $j$, $\mathbf{X}$ is a vector of landscape covariates, and $\beta$ is the effect of these covariates on movement.  

Considering $\mathbf{X}$, we explored two classes of covariates: location-based drivers and directional drivers of movement \citep{Hanks2015}.  Location-based drivers are a result of the cell that an animal is currently in and affect how long an animal remains in the current cell.  For example, if masting tree density was a negative location-based driver of pig movement then a pig in a cell with high masting tree density would tend to remain in that cell longer than a cell with lower masting tree density. Directional drivers of movement determine the direction that a pig might move once it leaves the cell it is currently occupying.  For example, if masting tree density was a positive directional driver of pig movement then, upon leaving the currently occupied cell, a pig tends to move in the direction of increasing masting tree density, relative to its current position [TODO: THIS IS A LOCAL dirIENT EFFECT...SHOULD WE ALSO EXPLORE GLOBAL EFFECTS AT SOME POINT? IN OTHER WORDS, does the presence of masting trees some where in the vicinity affect how a pig uses crop?]. Table 1 shows which of the covariates described in the previous section we considered as location-based drivers, directional drivers, or both.  

\subsection*{Model specification and fitting}

We analyzed three variations of the CTMC model with the goal of understanding the role of foraging resources on the movement of feral swine across populations.  Each model is described below

% In order to minimize computational and model complexity, we performed each of the following steps when fitting the models below.  First, for each population [study?], we fit a given model using a LASSO-regularized Poisson GLM .  This helped minimize the the number of covariates included in each model    we fit each model described below separately for all studies and used a post-hoc [regression analysis] to compare population-level effects across studies.  This was necessary as the imputed data for each model averaged 1 million data points with between 20-60 parameters being fit and regularized [fix wording and lingo].
\bigskip
\noindent
\emph{Model 1: Main effects model}

The first, and simplest, model that we analyzed only considered time-invariant main effects of anthropogenic and natural foraging resources as well as three other non-foraging covariates known to affect pig movement: canopy cover, sex, and distance to water.  The model is defined as

\begin{align}
  \log(\lambda_{ij}) = & \log(\tau_{ij}) + \beta_0 +  \beta_1 \text{directional persistence} + \beta_2 \text{male  } \\
  & + \beta_{3} \text{canopy cover}_{\text{loc}} + \beta_{4} \text{canopy cover}_{\text{dir}} \\
  & + \beta_5 \text{distance to water}_{\text{loc}} + \beta_6 \text{distance to water}_{\text{dir}} \\
  & + \beta_7 \text{distance to development}_{\text{loc}} + \beta_8 \text{distance to development}_{\text{dir}} \\
  & + \beta_9\text{distance to crops}_{\text{loc}} + \beta_{10}\text{distance to crops}_{\text{dir}} \\
  & + \beta_{11}\text{masting tree density}_{\text{loc}} + \beta_{12}\text{masting tree density}_{\text{dir}} \\
  & + \beta_{13}\text{NDVI}_{\text{loc}} + \beta_{14}\text{NDVI}_{\text{dir}}
\end{align}
where ``directional persistence'' describes the propensity of pigs to continue to move in the direction they moved in the previous time step.  the subscript ``loc'' refers to a location-based covariate (i.e. how that covariate effects the rate an animal is moving) and the subscript ``dir'' refers to a directional covariate (i.e. how that covariate effect the direction in which an animal moves).  We fit this model in two steps.  First, we fit the model using LASSO regularization using the \texttt{glmnet} package \citep{Friedman2010}.  LASSO simultaneously performs variable selection and shrinks [non-predictive or highly correlated] covariates to zero \cite{James2013}.  To select the best-model in terms of predictive performance, we performed 5-fold cross-validation [NOTE: that I probably need to do cross-validation for case-control studies] and chose the model with the maximum penalization parameter for which the Poisson deviance was within one standard error of the minimum out-of-sample deviance (provided in \texttt{glmnet}). This approach increases regularization and decreases the number of parameters in the model, at only a small cost to deviance. 

While advantageous for model selection, the aforementioned LASSO approach does not provide easy access to parameter uncertainty or incorporation of random effects.  We then refit model X, excluding the parameters removed by the LASSO, in a Bayesian framework. For each $\beta_i$ coefficient in the model, we included a random effect of individual. Specifically, given $k$ individual pigs in a population, we allowed $\beta_{i,k} \sim N(\mu_{\beta_i}, \sigma^2 \phi_i)$, which indicates that individual-level effects for parameter $i$ are drawn from a population-level distribution \citep{Buderman2018}. When $i > 1$, $\log(\phi_i) \sim N(0, 0.04)$, which weights the variance population-level variance for each $i$. When $i = 1$, $\phi_1 = 1$. For the population-level means, we specified the prior $\mu_{\beta_i} \sim N(0, 3)$.  In this model, the random effects of individuals for each covariate account for variation in resource use between individuals that were sampled at different times, in addition to inherent between-individual variability.  

Given the size of the ``data'' for each study (e.g. most studies had > 1 million predicted positions from the FMM model), we used automatic differentiation variational inference (ADVI) to approximate the posterior distributions of this Bayesian model \citep{Kucukelbir2015}. [Description of ADVI?]. Combining both ADVI and the preliminary LASSO regularization, allowed us to fit these models in a reasonable amount of time (e.g. X hours).

\bigskip
\noindent
\emph{Model 2: Time-varying movement model}

The second model we considered allowed pig movement and resource use to vary with time. We allowed overall movement speed to vary on both a daily and monthly time-scale and also allowed selection for forage resource, cover, and water to vary on a monthly time scale.  The model is given by

\begin{align}
  \log(\lambda_{ij}(h, m)) = & \log(\tau_{ij}) + \beta_0(h) + \beta_0(m) \\
  & + \beta_1 \text{directional persistence} + \beta_2 \text{male  } \\
  & + \beta_{3}(m) \text{canopy cover}_{\text{loc}} + \beta_{4}(m) \text{canopy cover}_{\text{dir}} \\
  & + \beta_5(m) \text{distance to water}_{\text{loc}} + \beta_6(m) \text{distance to water}_{\text{dir}} \\
  & + \beta_7 \text{distance to development}_{\text{loc}} + \beta_8 \text{distance to development}_{\text{dir}} \\
  & + \beta_9(m) \text{distance to crops}_{\text{loc}} + \beta_{10}(m) \text{distance to crops}_{\text{dir}} \\
  & + \beta_{11}(m) \text{masting tree density}_{\text{loc}} + \beta_{12}(m) \text{masting tree density}_{\text{dir}} \\
  & + \beta_{13}(m) \text{NDVI}_{\text{loc}} + \beta_{14}(m) \text{NDVI}_{\text{dir}}
\end{align}
where $h$ indicates the hour of the day and $m$ indicates the month of the year.  $\beta_0(h)$ describes how overall movement rate changes as a function of the hour of the day. $\beta_i(m)$ describes how the effect of a particular covariate varies with the month of the year. We modeled $\beta_0(h)$ using cyclic splines to ensure movement rate at the start of a 24 hour period was the same as movement rate at the end of the 24 hour period. We modeled $\beta_i(m)$ using cyclic-cubic regression splines when the data for pigs in a populations spanned 12 months \citep{Wood2006}. This ensured that the effect of a particular covariate was the same at the end December and the beginning of January.  When the data for a particular population did not span 12 months [NOTE: rarely, if ever, does a single pig span twelve months! Should we be fitting each pig separately?], we modeled $\beta_i(m)$ using a non-cyclic cubic spline [check terminology].

Similar to model 1, we performed LASSO regularization followed by an approximate Bayesian analysis using ADVI (see Supplementary Material).

\bigskip
\noindent
\emph{Model 3: Environmentally-driven movement model}

The final model we considered still allowed for overall movement speed to vary both daily and monthly, but now sought to describe the seasonal changes in selection for anthropogenic and natural forage in terms of monthly changes in precipitation and temperature.  Specifically, we replaced the monthly basis functions in model 3 with interactions between temperature, precipitation and forage resources, with the goal of more mechanistically understanding seasonal variation in resource use. 

\begin{align*}
  \log(\lambda_{ij}(h, m)) = & \log(\tau_{ij}) + \beta_0(h) + \beta_1' \text{season}_m \\
  & + \beta_2 \text{directional persistence} + \beta_3 \text{male  } \\
  & + \text{canopy cover}_{\text{loc}}(\beta_4 + \beta_4' \text{season}_m) \\
  & + \text{canopy cover}_{\text{dir}}(\beta_5 + \beta_5' \text{season}_m) \\
  & + \text{distance to water}_{\text{loc}}(\beta_6 + \beta_6' \text{season}_m) \\
  & + \text{distance to water}_{\text{dir}}(\beta_7 + \beta_7' \text{season}_m) \\
  & + \text{distance to crops}_{\text{loc}}(\beta_8 + \beta_8' \text{season}_m) \\
  & + \text{distance to crops}_{\text{dir}}(\beta_9 + \beta_9' \text{season}_m) \\
  & + \text{masting tree density}_{\text{loc}}(\beta_{10} + \beta_{10'} \text{season}_m) \\
  & + \text{masting tree density}_{\text{dir}}(\beta_{11} + \beta_{11'} \text{season}_m) \\
  & + \text{NDVI}_{\text{loc}}(\beta_{12} + \beta_{12'} \text{season}_m) \\
  & + \text{NDVI}_{\text{dir}}(\beta_{13} + \beta_{13'} \text{season}_m)
\end{align*}
where $\beta_i' \text{season}_m$ is the monthly effect of temperature and precipitation and is specifically given by {$\beta_{i, 1}\text{temperature}_m + \beta_{i, 2} \text{precipitation}_m + \beta_{i, 3} \text{temperature}_m \text{precipitation}_m$.  We used the same approach as model 1 when fitting the LASSO model. When incorporating random effects of individuals, we assumed that the effect of season was the same across individuals and that the random effect of individual was manifested in the $\beta_i$ coefficients (i.e. not the $\beta_i'$coefficients).  Otherwise, this random effects model was implemented as in model 1. 

\subsection*{Model comparison and population-level analyses}

For each of the aforementioned models, we then compared the predictive performance of these models to identify 1) whether there was statistical evidence for seasonal variation in resource use and 2) whether interactions between temperature 

For LASSO models...just compare CV deviance with standard error.

For ADVI models...check out LOO techniques.  These might work. 

\section*{Results}

\subsection*{Effects of non-foraging covariates on movement}

\subsection*{Effects of foraging covariates on movement}

\subsubsection*{Main effects models}

\subsubsection*{Time-varying effects}

\subsubsection*{Seasonal effects model}


\subsection*{Population-level analysis}


\section*{Discussion}

Temporal variation in selection for foraging resources...

With regards to management, 

\singlespacing
\bibliographystyle{/Users/mqwilber/Dropbox/Documents/Bibformats/mee.bst}
\bibliography{/Users/mqwilber/Dropbox/Documents/Bibfiles/Projects_and_Permits-feral_swine.bib}

\clearpage

\def\arraystretch{1.5}
\begin{sidewaystable}
\caption{Description of covariates used in analysis}
\begin{tabular}{p{4 cm}  p{4 cm}  p{4 cm}  p{4 cm}  p{4 cm}  p{2 cm} p{2cm}}
	Covariate & Description & Data Source & Spatial Resolution & Temporal Resolution & Location \newline or direction? \\
	\hline
	Normalized Difference \newline Vegetation Index (NDVI) & A proxy for plant productivity and natural forage availability.  & MODIS and NASS & 250 m $\times$ 250 m & Monthly & Both \\ 
	Density of hard-masting trees & & Tabak et al. & 1 km $\times$ 1 km & Time-invariant & Both \\
	Distance to crops & The distance to the nearest crop field. A measure of anthropogenic forage. & NASS & 30 m $\times$ 30 m & Yearly & Both \\
	Distance to water & The distance the nearest permanent or semi-permanent water source & NWI & 30 m $\times$ 30 m & Time-invariant & Both \\
	Canopy density [CHECK] & A proxy for habitat cover & NLCD & 30 m $\times$ 30 m & Time-invariant & Both \\
	Distance to developed-land & A measure of human presence & NLCD & 30 m $\times$ 30 m & Time-invariant & Both \\
	Temperature & Mean monthly temperature & NOAA & 50 km $\times$ 50 km & Monthly & Location \\
	Precipitation & Total monthly precipitation & NOAA & 50 km $\times$ 50 km & Monthly & Location \\

\end{tabular}
\end{sidewaystable}



%\section*{References}

\end{document}